---
phase: 01-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .claude/data-warehouse/prompts/system/base.md
  - .claude/data-warehouse/prompts/system/sql.md
  - .claude/data-warehouse/prompts/scenarios/.gitkeep
  - .claude/data-warehouse/context/global/sql-style.md
  - .claude/data-warehouse/context/domains/.gitkeep
  - .claude/data-warehouse/glossary/terms.md
  - .claude/data-warehouse/docs/.gitkeep
autonomous: true

must_haves:
  truths:
    - "目录结构遵循 <=3 层扁平原则，便于发现和维护"
    - "术语表覆盖 4 大领域（维度建模、分层体系、指标治理、SCD/增量），共 80+ 条目"
    - "团队通过统一术语避免翻译不一致，确保沟通无歧义"
    - "术语可被后续文档稳定引用，支持跨文档一致性检查"
  artifacts:
    - path: ".claude/data-warehouse/prompts/"
      provides: "提示文件目录结构"
    - path: ".claude/data-warehouse/context/"
      provides: "上下文文件目录结构"
    - path: ".claude/data-warehouse/glossary/terms.md"
      provides: "中英术语对照表（10 列格式，80+ 术语）"
      min_lines: 200
    - path: ".claude/data-warehouse/docs/"
      provides: "规范文档目录"
  key_links:
    - from: "glossary/terms.md"
      to: "后续所有提示和文档"
      via: "term_id 引用"
      pattern: "term_id.*snake_case"
      note: "ROADMAP 路径 zh-en-mapping.md 为占位符，RESEARCH.md 推荐 terms.md（更通用、简洁）"
---

<objective>
建立数据仓库提示系统的基础目录结构，并创建包含 80+ 术语的中英术语对照表。

Purpose: 为 Phase 2-8 的所有提示和文档提供统一的目录骨架和术语标准，确保术语一致性和文件可发现性。
Output: 标准化目录结构 + 术语表（10 列格式，覆盖维度建模/分层体系/指标治理/SCD 四大领域）
</objective>

<execution_context>
@./.claude/hivemind/workflows/execute-plan.md
@./.claude/hivemind/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-infrastructure/01-CONTEXT.md
@.planning/phases/01-infrastructure/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: 创建标准化目录结构</name>
  <files>
    .claude/data-warehouse/prompts/system/base.md
    .claude/data-warehouse/prompts/system/sql.md
    .claude/data-warehouse/prompts/scenarios/.gitkeep
    .claude/data-warehouse/context/global/sql-style.md
    .claude/data-warehouse/context/domains/.gitkeep
    .claude/data-warehouse/glossary/.gitkeep
    .claude/data-warehouse/docs/.gitkeep
  </files>
  <action>
创建 `.claude/data-warehouse/` 目录结构，遵循 RESEARCH.md 中定义的 <=3 层扁平结构：

```
.claude/data-warehouse/
├── prompts/
│   ├── system/                    # 跨场景稳定规则
│   │   ├── base.md                # 通用底座（写作风格、输出格式、边界）- 创建空模板
│   │   └── sql.md                 # SQL 生成规范 - 创建空模板
│   └── scenarios/                 # 一文件一场景（Phase 4-7 填充）
│       └── .gitkeep
│
├── context/
│   ├── global/                    # 全局知识与规范
│   │   └── sql-style.md           # SQL 风格规范 - 创建空模板
│   └── domains/                   # 一域一文件（Phase 2+ 填充）
│       └── .gitkeep
│
├── glossary/
│   └── .gitkeep                   # 术语表（Task 2 填充 terms.md）
│
└── docs/
    └── .gitkeep                   # 规范文档（Plan 02 填充）
```

**创建规则：**
1. 使用 mkdir -p 创建完整目录树
2. 在 scenarios/ 和 domains/ 放置 .gitkeep 保持空目录
3. 为 base.md、sql.md、sql-style.md 创建带 YAML frontmatter 的空模板文件：
   ```yaml
   ---
   type: prompt  # 或 context
   title: <占位符>
   status: draft
   version: 0.1.0
   domain: global
   owner: data-platform
   updated_at: 2026-01-30
   ---

   # <标题>

   <!-- Phase 2+ 填充内容 -->
   ```
  </action>
  <verify>
验证命令：
```bash
# 检查目录结构
ls -la .claude/data-warehouse/
ls -la .claude/data-warehouse/prompts/
ls -la .claude/data-warehouse/prompts/system/
ls -la .claude/data-warehouse/prompts/scenarios/
ls -la .claude/data-warehouse/context/
ls -la .claude/data-warehouse/context/global/
ls -la .claude/data-warehouse/context/domains/
ls -la .claude/data-warehouse/glossary/
ls -la .claude/data-warehouse/docs/

# 检查关键文件存在
test -f .claude/data-warehouse/prompts/system/base.md && echo "base.md exists"
test -f .claude/data-warehouse/prompts/system/sql.md && echo "sql.md exists"
test -f .claude/data-warehouse/context/global/sql-style.md && echo "sql-style.md exists"
```
  </verify>
  <done>
- 目录结构完整创建（prompts/, context/, glossary/, docs/）
- 嵌套深度 <=3 层
- 模板文件包含正确的 YAML frontmatter
- 空目录包含 .gitkeep
  </done>
</task>

<task type="auto">
  <name>Task 2: 编写中英术语对照表</name>
  <files>
    .claude/data-warehouse/glossary/terms.md
  </files>
  <action>
创建 `glossary/terms.md`，采用 RESEARCH.md 定义的 10 列 Markdown 格式。

**文件结构：**

```markdown
# 中英术语对照表

> 本文档定义 HiveMind 数仓助手的标准术语，所有提示和文档必须使用一致的术语表达。

## 术语权威原则

| 术语类型 | 权威来源 | 示例 |
|----------|----------|------|
| 方法论/建模语义 | **Kimball 优先** | fact, dimension, grain, SCD, 可加性, 总线矩阵 |
| 平台/产品对象 | **DataWorks 优先** | 节点、调度、资源、产品名词 |
| 项目自定义 | **项目规范** | ODS/DWD/DWS/ADS 分层、内部口径 |

---

## 1. 维度建模核心术语

| term_id | 中文 | English | 定义 | 示例 | 同义词/别名 | 领域 | Owner | 状态 | 更新日期 |
|---------|------|---------|------|------|-------------|------|-------|------|----------|
| modeling_fact_table | 事实表 | Fact Table | ... | ... | ... | modeling | data-platform | active | 2026-01-30 |
（继续添加术语...）

## 2. 分层体系术语
（同样格式...）

## 3. 指标治理术语
（同样格式...）

## 4. SCD/增量术语
（同样格式...）
```

**必须覆盖的术语领域（共 80+ 条目）：**

**1. 维度建模核心术语（约 25 条）：**
- 事实表 (Fact Table)、维度表 (Dimension Table)、星型模型 (Star Schema)、雪花模型 (Snowflake Schema)
- 粒度 (Grain)、度量/度量值 (Measure)、维度属性 (Dimension Attribute)
- 自然键 (Natural Key)、代理键 (Surrogate Key)、业务键 (Business Key)
- 可加事实 (Additive Fact)、半可加事实 (Semi-Additive Fact)、不可加事实 (Non-Additive Fact)
- 事务事实表 (Transaction Fact Table)、周期快照事实表 (Periodic Snapshot Fact Table)
- 累积快照事实表 (Accumulating Snapshot Fact Table)、无事实事实表 (Factless Fact Table)
- 一致性维度 (Conformed Dimension)、角色扮演维度 (Role-Playing Dimension)
- 退化维度 (Degenerate Dimension)、杂项维度 (Junk Dimension)
- 桥接表 (Bridge Table)、总线矩阵 (Bus Matrix)
- 维度层级 (Dimension Hierarchy)、钻取 (Drill Down/Up)

**2. 分层体系术语（约 15 条）：**
- 操作数据层/贴源层 (ODS - Operational Data Store)
- 明细数据层 (DWD - Data Warehouse Detail)
- 汇总数据层/主题层 (DWS - Data Warehouse Summary)
- 应用数据层/数据服务层 (ADS - Application Data Service)
- 临时表 (Staging Table)、中间表 (Intermediate Table)
- 数据域 (Data Domain)、主题域 (Subject Area)
- 数据集市 (Data Mart)、数据仓库 (Data Warehouse)
- 公共维度层 (Dimension Layer)
- 跨层引用 (Cross-Layer Reference)、层间依赖 (Layer Dependency)

**3. 指标治理术语（约 20 条）：**
- 指标 (Metric/Indicator)、原子指标 (Atomic Metric)
- 派生指标 (Derived Metric)、复合指标 (Composite Metric)
- 维度 (Dimension - 分析维度)、口径 (Caliber/Definition)
- 指标公式 (Metric Formula)、计算逻辑 (Calculation Logic)
- 时间粒度 (Time Granularity)、业务过程 (Business Process)
- 数据新鲜度 (Data Freshness)、数据时效 (Data Timeliness)
- 指标分类 (Metric Category)、指标标签 (Metric Tag)
- 数据所有者 (Data Owner)、数据管家 (Data Steward)
- 语义层 (Semantic Layer)

**4. SCD/增量术语（约 20 条）：**
- 缓慢变化维度 (Slowly Changing Dimension - SCD)
- SCD Type 1（覆盖）、SCD Type 2（历史追踪）、SCD Type 3（前/当前值）
- 有效期起始 (Valid From / dw_valid_from)、有效期截止 (Valid To / dw_valid_to)
- 当前标识 (Is Current / is_current)、版本号 (Version Number)
- 增量加载 (Incremental Load)、全量加载 (Full Load)
- 分区回刷 (Partition Overwrite)、INSERT OVERWRITE
- T+1 离线 (T+1 Offline)、批处理 (Batch Processing)
- ETL 时间戳 (ETL Timestamp)、创建时间 (Create Time)、修改时间 (Modify Time)
- 数据快照 (Data Snapshot)、历史表 (History Table)
- 分区键 (Partition Key)、分区裁剪 (Partition Pruning)

**term_id 命名规则：**
- 格式：`<domain>_<slug>`（snake_case）
- domain 值：`modeling`（建模）、`layer`（分层）、`metric`（指标）、`scd`（SCD/增量）
- slug：使用英文术语简写或下划线连接的英文词

**10 列定义：**
1. `term_id`: ASCII snake_case 格式的稳定标识符
2. `中文`: 中文术语
3. `English`: 英文术语
4. `定义`: 术语的明确定义（1-2 句话）
5. `示例`: 代码片段或场景句子
6. `同义词/别名`: 其他叫法，用 `|` 分隔
7. `领域(domain)`: modeling / layer / metric / scd
8. `Owner`: 负责团队（默认 data-platform）
9. `状态`: active / draft / deprecated
10. `更新日期`: YYYY-MM-DD 格式

**注意：**
- 定义必须清晰准确，参考 Kimball Group 官方定义
- 示例要实用（代码片段用 backticks 包裹，如 `dwd_fact_orders`）
- 同义词帮助用户找到术语（如"维表|维度"）

**term_id 引用机制（供后续文档使用）：**

在术语表开头添加引用说明：

```markdown
## 如何引用术语

在其他文档中引用术语时，使用以下语法：

1. **行内引用**：`[术语中文](glossary/terms.md#term_id)`
   - 示例：`[事实表](glossary/terms.md#modeling_fact_table)`

2. **定义列表引用**（用于需要展示定义的场景）：
   - 引用 `modeling_grain` 了解粒度的含义

3. **批量引用**（用于文档头部声明依赖）：
   ```yaml
   术语依赖:
     - modeling_fact_table
     - modeling_dimension
     - layer_dwd
   ```

使用稳定的 `term_id` 确保即使中文名称调整，引用关系也不会断裂。
```
  </action>
  <verify>
验证命令：
```bash
# 检查文件存在
test -f .claude/data-warehouse/glossary/terms.md && echo "terms.md exists"

# 检查术语数量（每个表格行以 | 开头，排除表头和分隔线）
grep -c "^| [a-z]" .claude/data-warehouse/glossary/terms.md

# 检查 4 大领域都有覆盖
grep -c "| modeling |" .claude/data-warehouse/glossary/terms.md
grep -c "| layer |" .claude/data-warehouse/glossary/terms.md
grep -c "| metric |" .claude/data-warehouse/glossary/terms.md
grep -c "| scd |" .claude/data-warehouse/glossary/terms.md

# 检查 10 列格式（表头行）
head -30 .claude/data-warehouse/glossary/terms.md | grep "term_id.*中文.*English.*定义.*示例.*同义词"
```
  </verify>
  <done>
- terms.md 文件创建成功
- 包含 80+ 术语条目
- 覆盖 4 大领域：维度建模、分层体系、指标治理、SCD/增量
- 采用 10 列格式，包含 term_id、定义、示例、Owner 等字段
- 所有 term_id 使用 ASCII snake_case 格式
- 包含术语权威原则说明
  </done>
</task>

</tasks>

<verification>
整体验证：

1. **目录结构验证：**
   ```bash
   find .claude/data-warehouse -type d | wc -l  # 应该 >= 8 个目录
   find .claude/data-warehouse -type f | wc -l  # 应该 >= 5 个文件
   ```

2. **术语表验证：**
   ```bash
   # 统计总术语数（应 >= 80）
   grep -E "^\| [a-z]+_" .claude/data-warehouse/glossary/terms.md | wc -l
   ```

3. **格式验证：**
   - 模板文件包含 YAML frontmatter（`---` 开头和结尾）
   - 术语表使用正确的 10 列格式
</verification>

<success_criteria>
1. 目录结构完整创建，遵循 <=3 层扁平原则
2. 术语表包含 80+ 术语条目
3. 术语表覆盖 4 大领域（维度建模、分层体系、指标治理、SCD/增量）
4. 术语表采用 10 列格式，term_id 使用 ASCII snake_case
5. 所有模板文件包含正确的 YAML frontmatter
</success_criteria>

<output>
完成后创建 `.planning/phases/01-infrastructure/01-01-SUMMARY.md`
</output>
